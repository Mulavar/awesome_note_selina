## 事务隔离概念

在 MySQL 中，事务支持是在引擎层实现的。MySQL 是一个支持多引擎的系统，但并不是所有的引擎都支持事务。比如 MySQL 原生的 MyISAM 引擎就不支持事务，这也是 MyISAM 被 InnoDB 取代的重要原因之一。

SQL 标准的事务隔离级别包括：

- 读未提交：一个事务未提交时，它的改动就能被其他事务看到。
- 读已提交：一个事务提交后，它的改动才能被其他事务看到。
- 可重复读：一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。
- 串行化：对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。

在实现上，数据库会创建一个一致性视图（consistent read view），具体访问结果以视图的逻辑结果为准。其中，“可重复读”是在事务启动时创建视图，而读提交是每条 SQL 语句都会创建一个视图。读未提交则直接读取最新状态数据，没有视图的概念，串行化则是直接使用加锁的方式实现。

Oracle 数据库的默认隔离级别其实就是“读提交”，因此对于一些从 Oracle 迁移到 MySQL 的应用，为保证数据库隔离级别的一致，你一定要记得将 MySQL 的隔离级别设置为“读提交”



## 事务隔离实现

在 Innodb 引擎中，同一条记录可以有多个版本，每次该记录被更新的时候都会同时记录一个回滚操作，记录上的最新值通过回滚可以获得之前版本的数据，即多版本并发控制（MVCC）机制。